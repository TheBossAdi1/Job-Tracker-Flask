{% extends "layout.html" %}

{% block title %}Charts{% endblock %}

{% block content %}
<h2>Applications Statistics</h2>

<div style="display:flex; gap:40px; flex-wrap:wrap;">
    <div style="width:400px;">
        <h3>Status</h3>
        <canvas id="statusChart"></canvas>
    </div>

    <div style="width:400px;">
        <h3>Job Type</h3>
        <canvas id="jobTypeChart"></canvas>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const statusData = JSON.parse(`{{ status_data | tojson }}`);
    const jobTypeData = JSON.parse(`{{ job_type_data | tojson }}`);

    new Chart(document.getElementById("statusChart"), {
        type: "pie",
        data: {
            labels: statusData.map(x => x.status),
            datasets: [{
                data: statusData.map(x => x.count),
                backgroundColor: ["#ff6384", "#36a2eb", "#ffcd56", "#4bc0c0", "#9966ff"]
            }]
        }
    });

    new Chart(document.getElementById("jobTypeChart"), {
        type: "pie",
        data: {
            labels: jobTypeData.map(x => x.job_type),
            datasets: [{
                data: jobTypeData.map(x => x.count),
                backgroundColor: ["#36a2eb", "#ff6384", "#ffcd56", "#4bc0c0"]
            }]
        }
    });
</script>

{% endblock %}
